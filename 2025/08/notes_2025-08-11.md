[Home](../../main.md) | [Prev: Day 207](notes_2025-08-08.md) | [Next: Day 209](./notes_2025-08-12.md)

## üìù Day 208, Monday - `notes_2025-08-11.md`

### US348
- Create a tool to transform user Mass-Spec data to a standardized analysis format
    * work on `acetylation_analysis.ipynb`
    * able to pivot data from `.txt` file
    * subsequent peptide acetylation proportion calculation
    * Mass Spec data is generated by our biology team for reviewing acetylation of key lysine residues on a protein.  THe data is generated in a tall-skinny format and the scientists would like to extract and transform the results to simplify summary analyses.  

#### PTM analysis using mass-spec
*   **Post-Translational Modifications (PTMs):** These are chemical modifications of proteins that occur after their synthesis (translation). Acetylation, the addition of an acetyl group (CH‚ÇÉCO) to an amino acid residue (typically lysine), is a common PTM that can alter protein function, stability, or interactions.
*   **Mass Shift Detection:** Each PTM adds a specific mass to a protein or peptide. For acetylation, an acetyl group adds approximately 42.01056 Da (Daltons) to a lysine residue. Mass spectrometers measure the mass-to-charge ratio (m/z) of ions. By comparing the m/z of a peptide before and after modification, or by searching for peptides with this specific mass increment, the presence of an acetylation can be inferred.
*   **Tandem Mass Spectrometry (MS/MS or MS2):** After an initial mass measurement (MS1) identifies precursor ions (peptides), selected precursor ions are fragmented (e.g., using collision-induced dissociation, CID). The resulting fragment ions are then measured in a second stage (MS2). The fragmentation pattern reveals the amino acid sequence of the peptide. If a PTM is present, the mass shift will be observed in specific fragment ions, allowing localization of the modification to a particular amino acid within the sequence.
*   **Database Searching and Bioinformatic Analysis:** The acquired MS/MS spectra are searched against protein sequence databases (e.g., UniProt) to identify the parent protein and peptide. Specialized software is used to search for peptides that match the experimental data, considering potential PTMs like acetylation at specific sites. This helps confirm the identity of the modified peptide and the exact residue where the PTM occurred.
*   **Quantitative Analysis:** Once acetylated peptides are identified, their abundance can be quantified. This might involve label-free approaches (comparing peak intensities), or stable isotope labeling techniques (e.g., SILAC, TMT, iTRAQ) where differentially labeled peptides are mixed and analyzed, allowing relative or absolute quantification of the acetylation level under different biological conditions.

### US341
- develop script to ingest tecan file and upload using mosaic api
    * work on adding logic to read the raw tecan file to get the plate ids (barcodes)
    * update config on neovim lualine plugin to show spinner when LLM is loading
    * 3 main options discussed on how to incorporate logic for handling different plate ids (barcodes) in raw csv files:
        1. create a `.txt` file with experiment ID as file name
            * simple, but user make easily make errors, additional steps, quite messy
        2. make an on-going schedule that pings DTX and MOSAIC for newly added barcodes (plate ids)
            * significant code to add; can introduce more error-prone steps, will bloat the logs due batch processing (each payload is already ~8k lines of json)
        3. parse the original raw file twice and get the plate ids (barcodes) 
            * makes the most sense without adding extra steps for users and additional significant code
    * the `context_read_file()` has the following dict keys:
        * the `body` value is in bytes, need to convert (decode)
    *   **New Imports**: Added `csv` and `io.StringIO` to handle CSV data parsing from file contents.
    *   **SQL Query Modification**: The SQL query logic was updated to filter by `name IN %(barcodes)s` instead of `experiment_id = %(exp_id)s`, allowing for multiple barcodes to be queried.
    *   **Function Refactoring (`get_exp_id_from_file` to `get_file_name`)**:
        *   The `get_exp_id_from_file` function was renamed to `get_file_name`.
        *   It now solely extracts and returns the URI-quoted file name, removing the functionality to extract an experimental ID (`exp_id`).
    *   **New Function (`parse_file_for_barcode`)**:
        *   A new function `parse_file_for_barcode` was introduced.
        *   This function reads the raw file content from the input pointer.
        *   It parses a specific "Plates" section within the file (structured as CSV).
        *   It extracts all "Plate name" values from this section and returns them as a tuple of barcodes.
    *   **`create_mosaic_labware` Updates**:
        *   The `create_mosaic_labware` function was updated to use the new `get_file_name` and `parse_file_for_barcode` functions.
        *   The extracted `barcodes` from the file content are now passed as parameters to the SQL query.

```json
  "metadata": {
    "ts_os_createdtime": "2025-07-31T18:37:49.7832807Z",
    "ts_os_sizeondisk": "469886",
    "ts_agent": "TetraScience.Agent.file-log v4.4.1",
    "ts_file_id": "d40d09bb-7a1a-4e05-8e59-1db594f9aa0f",
    "ts_raw_md5_checksum": "GncAm27BPmAHynGTDutKeA==",
    "ts_os_lastmodifiedtime": "2025-07-31T18:40:17.1136610Z",
    "ts_integration_metadata": "",
    "ts_integration_source": "225a5b09-5ebc-43c5-93b9-8058f83dd311",
    "ts_integration_id": "6f166302-df8a-4044-ab4b-7ddd3eefb50b",
    "ts_source_type": "shared-drive",
    "ts_trace_id": "d40d09bb-7a1a-4e05-8e59-1db594f9aa0f",
    "ts_integration_type": "api",
    "ts_source_name": "strinh-test-agent",
    "ts_integration_tags": "",
    "ts_os_file_path": "D:\\Screening\\Tecan_Mosaic_UAT\\274507 2025-07-24 1323.csv"
  },
  "custom_metadata": {},
  "custom_tags": [],
  "body": "en-US,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,\r\nSummary,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,\r\nProtocol,C:\\Users\\AmyCrossan\\Prelude Therapeutics\\Tecan D300e - Documents\\Compound"
```
