[Home](../../main.md) | [Prev: Day 214](notes_2025-08-19.md) | [Next: Day 216](./notes_2025-08-21.md)

## 📝 Day 215, Wednesday - `notes_2025-08-20.md`

### US356
- assist with tetrascience pherastar pipeline processing on UAT
    * during meeting did real-time troubleshooting again, the error in pipeline suggests there are sections missing in the raw input file (`.csv`)
    * after checking the content indeed sections were missing; which led to thought that the input raw file was for Envision and not for Pherastar; simply need to re-trigger the pipeline with proper raw input file

### US341
- develop script to ingest tecan file and upload using mosaic api
    * included `README.md` in the `/task-scripts` directory to be displayed in the protocol section of the pipeline (on TS platform)
    * made slight changes to `/task-scripts/main.py`:
        * remove rtn type (dict) for `validate_barcodes()`
        * update the docs for the return description
        * change final prnt stmt for `validate_barcodes()`
        * use of with context for the cursor execution in `create_mosaic_labware()`
    * awaiting 2x `.txt` files to be provided to test the pipeline


### US352
- New ADC Project planning
    * prevent un-authorised users from seeing the CALR data in bioregister
    * initial idea was to use validation sql to prevent certain users from seeing the CAL-R data in bioregister  browser project, however after initial investigation, it doesn't seem like it would work because the validation sql is only available for labels (buttons) and not for tables
    * another possible option is to use `pop-ups`:

>**Popups** have a variety of uses when they are associated with form objects and provide actionable events when clicking a field value after a query. They are most commonly used to drill down into data underlying aggregate values, run queries across projects, generate summary graphs of data or to execute data exports or other Browser views.  They are also used to pass data between various modules (**Browser**, **Studies**, **Register**, etc.), and into subsequent queries, URLs and views.

- however would require significant effort to re-factor the form and it will visually not be equivalent since pop-ups have limited css and styling
- seems most likely option is to create new project code and new DS and project

- experimented with codified css styling in sql table:

```sql
with cte_capital_ub as (
    select distinct isid 
    from DS3_APPDATA.BROWSER_GROUPS_USERS
),
cte_palette as (
    select column_value as hex_color
    from table(sys.odcivarchar2list(
        '#1f77b4', '#ff7f0e', '#2ca02c', '#d62728', '#9467bd',
        '#8c564b', '#e377c2', '#7f7f7f', '#bcbd22', '#17becf',
        '#393b79', '#637939', '#8c6d31', '#843c39', '#7b4173',
        '#3182bd', '#31a354', '#756bb1', '#636363', '#e6550d',
        '#969696', '#cedb9c', '#9c9ede', '#e7ba52', '#ad494a',
        '#a55194', '#6baed6', '#74c476', '#9e9ac8', '#bdbdbd'
    ))
),
cte_numbered as (
    select lower(isid) as isid,
           row_number() over (order by isid) as rn
    from cte_capital_ub
),
cte_colored as (
    select n.isid,
           p.hex_color
    from cte_numbered n
    join (
        select hex_color, rownum as rn
        from cte_palette
    ) p
    on mod(n.rn-1, (select count(*) from cte_palette)) + 1 = p.rn
)
select isid,
       'background-color: ' || hex_color || '; color: black;' as style_css
from cte_colored
order by isid
```

#### Dynamic datasource [link](https://documentation.dotmatics.com/br/6.2/admin-guide/datasources-admin/dynamic-datasources):

>In this example, the SQL statement checks that the current user is a member of a Studies group that has access to the protocol for each experiment stored in the main table, and so will only populate the Browser project with experiments that they would have access to within the Studies module.

> This kind of setup can be used to limit access to certain Studies or Browser user groups (for example CROs or external customers) so that they can only access and browse a limited subset of the data available on the system.

>Note that the performance of dynamic datasources can be slower than a standard summary datasource view. However, to achieve the same effect in the above example using views, an admin would need to (1) create as many cloned Browser projects as there are Studies groups, (2) change the summary datasource for each, (3) give access to the correct project to each user, and (4) would have to add new ones as new groups and users were created. In these situations, a dynamic datasource can be the more efficient option.

- `ADC_TARGET_VW` and `ADC_BATCH_INFO` and `ADC_REG_INFO` and  `ADC_INV_INFO` are the backend DS that would need to be converted to dynamic datasources
